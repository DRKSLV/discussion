{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.c9411c33f6d649919d0e.hot-update.js","sources":["webpack:///./components/Vote.js"],"sourcesContent":["import {useState, useEffect} from 'react';\r\n//import axios from \"axios\";\r\n\r\nimport UpIcon from \"../res/svg/upvote5.svg\";\r\nimport DownIcon from \"../res/svg/downvote5.svg\";\r\n\r\nimport { Threadindent } from \"./threadindent\"\r\n\r\nimport s from \"../style/post.module.sass\";\r\nimport { useIdentity} from '../hooks/identity';\r\nimport { MdSentimentSatisfied } from 'react-icons/md';\r\n\r\nexport function Vote(props) {\r\n    //Props\r\n    var [voteCount, setVoteCount]= useState(props.up-props.down); \r\n    var  [id, axios]= useIdentity();\r\n    var initial = 0;\r\n    if(typeof props.my === \"boolean\") {\r\n        initial= props.my===true ? 1 : -1;\r\n    }\r\n\r\n    //Hooks\r\n    const [vote, setVote] = useState(initial);\r\n    console.log(vote);\r\n\r\n    useEffect(() => {\r\n        setVote(initial);\r\n    }, [initial])\r\n\r\n    //Api\r\n    function request(val) {\r\n        console.log(\"vote commited\");\r\n        var lol = \"true\";\r\n        if(val === 0) \r\n            lol = \"null\";      \r\n        if(val === -1) \r\n            lol = \"false\";\r\n\r\n\r\n        axios.post(`/entity/${props.id}/vote`, {\r\n            value: lol\r\n        })\r\n        .then(function (response) {\r\n            setVoteCount(parseVotes(response.data));\r\n        })\r\n        .catch(function (error) {\r\n            console.log(error);\r\n            //console.log(error.response.data);\r\n        });\r\n    }\r\n\r\n    //events\r\n    function click(val) {\r\n        console.log(\"clicked\");\r\n        if(props.dummy) {\r\n            return;\r\n        }\r\n        request(val);\r\n        setVote(prev => prev !== val ? val : 0);\r\n    }\r\n\r\n    function parseVotes(votes) {\r\n        if(props.dummy) {\r\n            return 0;\r\n        }\r\n        return votes[0] ? ((votes[0].upvotes || 0) - (votes[0].downvotes || 0)) : 0 // votes - downvotes\r\n    }\r\n\r\n    return (\r\n        <div className={props.small?s.voteSmall:s.vote}>\r\n            <UpIcon onClick={(e) => {click(1); e.stopPropagation();}} className={s.upvote} data-active={vote===1}></UpIcon>\r\n            <div><span>{props.dummy? \"N/A\" : voteCount}</span></div>\r\n            <UpIcon onClick={(e) => {click(-1); e.stopPropagation();}} className={s.downvote} data-active={vote===-1}></UpIcon>\r\n        </div>\r\n    );\r\n}\r\n\r\n// stroke=\"#ff004f\"\r\n//fill=\"#f60\" stroke=\"rgb(31, 152, 229)\"\r\n// fill=\"#f60\""],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AATA;AAAA;AAAA;AACA;AAUA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAIA;AACA;AADA;AAIA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAGA;AACA;;;;A","sourceRoot":""}