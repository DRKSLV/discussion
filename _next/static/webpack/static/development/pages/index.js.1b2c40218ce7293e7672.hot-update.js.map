{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.1b2c40218ce7293e7672.hot-update.js","sources":["webpack:///./components/Post.js"],"sourcesContent":["import { useState, useRef, useEffect, useContext } from \"react\";\r\n\r\nimport CommentIcon from \"../res/svg/commentIcon.svg\"\r\nimport { Vote } from \"./Vote\";\r\nimport { Timestamp } from \"./Timestamp\"\r\n\r\nimport s from \"../style/post.module.sass\";\r\n\r\nimport { CommentSection } from \"./CommentSection\";\r\nimport { DropdownItem } from '../components/MultilevelMenu';\r\n\r\n//markdown styling\r\nimport mdStyle from \"../style/document.module.sass\";\r\nimport markdown from \"../helpers/markdown\";\r\nconst md = markdown({anchor: false, embeds: false, supressHeadings: true});\r\n\r\nimport {MenuData} from \"./layout/ContextMenu\";\r\nimport { useIdentity } from \"../hooks/identity\";\r\n\r\n\r\n\r\nexport const Post = React.forwardRef((props, ref) => {\r\n    var p = props.post;\r\n    var [commentsOpen, setCommentsOpen] = useState(false);\r\n    var [collapsed, setCollapsed] = useState(false);\r\n\r\n    //----show a context menu on rightclick\r\n    var contextMenu = useContext(MenuData);\r\n    var [id, axios] = useIdentity();\r\n\r\n\r\n\r\n    function context(evt) {\r\n        contextMenu.openMenu(evt.pageX, evt.pageY, [\r\n            <DropdownItem text=\"Edit\"/>,\r\n            <DropdownItem text=\"E\"/>,\r\n            <DropdownItem text=\"Delete\"/>\r\n        ]); \r\n        evt.preventDefault();\r\n    }\r\n\r\n    //----Expand when clicked\r\n    const bodyRef = useRef();\r\n    \r\n    useEffect(() => {\r\n        setCollapsed(!commentsOpen && bodyRef.current.clientHeight>350);\r\n    }, [bodyRef, commentsOpen])\r\n\r\n    var expandTime;\r\n    if(bodyRef.current) {\r\n        expandTime = 0.71428571429 * bodyRef.current.clientHeight-350;\r\n    }\r\n\r\n    return (\r\n        <div className={s.postWrapper}>\r\n            <div className={s.post} \r\n                onClick={()=>setCommentsOpen(!commentsOpen)} \r\n                onContextMenu={context}\r\n                data-expanded={commentsOpen}\r\n            >\r\n                <Vote up={p.entity.upvotes} down={p.entity.downvotes} id={p.entity.id}></Vote>\r\n                <div className={s.content} ref={ref}>\r\n                    <div>\r\n                        <div className={s.comments}>\r\n                            {(p.entity.comment.rgt-p.entity.comment.lft-1)/2}\r\n                            <CommentIcon/>\r\n                        </div>\r\n                        <p className={s.title}>\r\n                            <b>{p.title}</b><br/>\r\n                            <span className={s.author}>posted by {p.author ? p.author.username : \"❌DELETED❌\"}</span>\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className={s.body} style={{maxHeight: !commentsOpen ? \"350px\" : bodyRef.current.clientHeight+10, \"--expandtime\": expandTime+\"ms\", overflow:\"hidden\"}}>\r\n                        <div dangerouslySetInnerHTML={{__html: md(p.text)}} className={mdStyle.mdPost} ref={bodyRef}></div>\r\n                        {collapsed && <div className={s.expandDialogWrapper}><div className={s.expandDialog}>Click to Expand</div></div>}\r\n                    </div>\r\n                    \r\n                    <Timestamp time={p.createdAt} edit={p.updatedAt}></Timestamp>\r\n                </div>\r\n            </div>\r\n            <CommentSection id={p.entity.id} open={commentsOpen} key={\"cs\"+p.entity.id}/>\r\n        </div>\r\n    );\r\n});"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAIA;AACA;AACA;AAFA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AACA;AAIA;AACA;AAPA;AAAA;AAAA;AAAA;AACA;AAUA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;A","sourceRoot":""}