(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"2TGF":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n("o0o1"),a=n.n(r),o=n("ODXe"),c=n("q1tI"),u=n.n(c),s=n("80PL"),l=n("q9vl"),i=n("LYgV"),p=n.n(i),f=n("ma3e"),b=u.a.createElement;function m(){return b(s.a,null,b(d,null))}function d(){var e=Object(l.b)(),t=Object(o.a)(e,2),n=t[0],r=t[1],u=Object(c.useState)({}),s=u[0],i=u[1],m=Object(c.useState)(null),d=m[0],v=m[1];Object(c.useEffect)((function(){n.users[n.active]&&function(){var e;a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(r.get("/place/here"));case 2:e=t.sent,i(e.data);case 4:case"end":return t.stop()}}),null,null,null,Promise)}()}),[n.active,d]);var h=s.pathTo||[];function g(e,t){var o,c;return a.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(n.users[n.active]){u.next=2;break}return u.abrupt("return");case 2:return u.prev=2,u.next=5,a.a.awrap(r.get("/place/travel/".concat(e)));case 5:o=u.sent,v(t),u.next=16;break;case 9:if(u.prev=9,u.t0=u.catch(2),!u.t0.response||403!==u.t0.response.status){u.next=15;break}return(c=u.t0.response.data).sendTo&&v(c.sendTo),u.abrupt("return",u.t0.response.data);case 15:v(null);case 16:return u.abrupt("return",o.data);case 17:case"end":return u.stop()}}),null,null,[[2,9]],Promise)}return h=h.concat((s.pathFrom||[]).filter((function(e){return!0===e.path.twoWay}))),b("div",{className:p.a.place},b("h1",null,s.name),b("p",null,s.description),b("div",{className:p.a.pathList},b("b",null,b(f.h,{size:"1em"})," Paths:"),b("div",null,h.map((function(e,t){return b(_,{key:e.path.id,target:e,nav:g})})))))}function _(e){var t=e.target,n=Object(c.useRef)(),r=Object(c.useState)(null),o=r[0],s=r[1];return b("div",{className:p.a.pathEntry,onClick:function(){var r;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,a.a.awrap(e.nav(t.path.id,t.id));case 2:if("travel allowed:"!==(r=o.sent)){o.next=6;break}return s(!1),o.abrupt("return");case 6:(r.veteran||r.gnome||r.stuck)&&(n.current.classList.remove(p.a.wrong),n.current.offsetWidth,n.current.classList.add(p.a.wrong),r.stuck&&s(b(u.a.Fragment,null,"Stuck!",b("br",null),b(v,{time:r.stuck.free}))),r.gnome&&s("No Gnomes!"),r.veteran&&s("only Veterans!"));case 8:case"end":return o.stop()}}),null,null,null,Promise)},"data-expanded":e.disabled,ref:n},b("p",null,b("b",null,t.path.name||"Path")," ",b("span",null,"to"),b("br",null),b("i",null,t.name)),b("p",{className:p.a.blocked},o&&b(u.a.Fragment,null,b(f.o,null)," ",o)))}function v(e){var t=Object(c.useState)(new Date(e.time)-new Date),n=t[0],r=t[1];Object(c.useEffect)((function(){var t=setInterval((function(){var n=new Date(e.time)-new Date;n>0?r(n):clearInterval(t)}),1e3);return function(){clearInterval(t)}}),[]);var a=Math.floor(n/6e4);n-=6e4*a;var o=Math.floor(n/1e3);return b("span",null,a,":",o)}},"80PL":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("q1tI"),a=n.n(r),o=n("8Kt/"),c=n.n(o),u=n("NIcq"),s=n("q9vl"),l=n("40RG"),i=n("SKjy"),p=n("e6a3"),f=n("PmZg"),b=n("Srb5"),m=n("jxK0"),d=n("FCqg"),_=n("ma3e"),v=n("ecW4"),h=a.a.createElement;function g(e){return h(m.d,null,h(c.a,null,h("title",null,"Civil Discussion")),h(s.a,null,h(b.a,{style:{backgroundColor:"#181a1b",height:"100vh",width:"100vw"}},h(d.a,{title:e.title,rerenderFunc:function(){}},h(d.b,{icon:h(_.m,null),drawer:h(v.a,null)}),h(d.b,{icon:h(_.p,null)},h(i.a,null,h(i.b,{text:"Profile"}),h(i.b,{leftIcon:h(u.d,null),text:"Switch Acount"},h(l.b,null)),h(p.a,null),h(i.b,{leftIcon:h(u.c,null),text:"Account Settings"}))),h(d.b,{icon:h(u.c,null)},h(i.a,null,h(i.b,{text:"Dark Theme"}),h(i.b,{text:"Privacy Policy",link:"/discussion/privacy"})))),h(f.a,null,e.children))))}},LYgV:function(e,t,n){e.exports={card:"place_card__2C6YO",animCard:"place_animCard__3WGbI",pathEntry:"place_pathEntry__3P6LH",cardEntrance:"place_cardEntrance__1ZcYY",entering:"place_entering__jgX3y",cardboardEntrance:"place_cardboardEntrance__3_cpc",list:"place_list__3qVaQ",place:"place_place__1OHIf",fabulous:"place_fabulous__1Lc6o",scroll:"place_scroll__2OgJ-",centerAbsolute:"place_centerAbsolute__LMNbu",wrong:"place_wrong__16kIW",redflash:"place_redflash__36Ksr",blocked:"place_blocked__75ycY",pathList:"place_pathList__U04D7"}},O1IP:function(e,t,n){e.exports={form:"postForm_form__Oczvn",postForm:"postForm_postForm__eQJ-A",registerForm:"postForm_registerForm__1bmo3",baseButton:"postForm_baseButton__3FQfE",accountFormWrap:"postForm_accountFormWrap__138CC",usernameHighlight:"postForm_usernameHighlight__OITtg",removeButton:"postForm_removeButton__5_hKK",clicked:"postForm_clicked__2ebhs",accountFormsAlign:"postForm_accountFormsAlign__2EQp5",tabWrapper:"postForm_tabWrapper__2wp4y",tabBar:"postForm_tabBar__2RJae",tab:"postForm_tab__1A3gY",submitButton:"postForm_submitButton__WO9kK",postButton:"postForm_postButton__1GP0x",destructiveButton:"postForm_destructiveButton__10KJ-",jumping:"postForm_jumping__3WKtO",rotating:"postForm_rotating__1YuS7",title:"postForm_title__3evoo",titleCounter:"postForm_titleCounter__QnXSx",author:"postForm_author__31Fn5"}},Srb5:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return p}));var r=n("q1tI"),a=n.n(r),o=n("SKjy"),c=n("hKBk"),u=n.n(c),s=n("B68i"),l=a.a.createElement,i=Object(r.createContext)({});function p(e){var t=Object(r.useState)(!1),n=t[0],c=t[1],p=Object(r.useState)([0,0]),f=p[0],b=p[1],m=Object(r.useState)([l(o.b,{text:"Dark Theme"}),l("hr",null),l(o.b,{text:"Privacy Policy"})]),d=m[0],_=m[1];if(n)var v={left:"min( calc( 100vw - 205px ),   "+f[0]+"px  )",top:"min( calc( 100vh + "+document.body.scrollHeight+"px - 205px ),   "+f[1]+"px  )",display:n?"block":"none"};function h(){c(!1)}var g=d.map((function(e,t){return a.a.cloneElement(e,{key:t})}));return l("div",{style:e.style},l(i.Provider,{value:{openMenu:function(e,t,n){n&&(c(!0),b([e,t]),_(n))},removeMenu:h}},e.children),l(s.a,{className:u.a.menuMover,component:"div",onClickOutside:function(){h()},style:v},n&&l(o.a,{small:!0},g)))}},e6a3:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("o0o1"),a=n.n(r),o=n("rePB"),c=n("ODXe"),u=n("q1tI"),s=n.n(u),l=n("SKjy"),i=n("ma3e"),p=n("q9vl"),f=n("v0uu"),b=s.a.createElement;function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(){var e=Object(p.b)(),t=Object(c.a)(e,2),n=t[0],r=t[1],o=Object(u.useState)({}),m=o[0],_=o[1],h=n.users[n.active],g=Object(u.useState)(!1);g[0],g[1];Object(u.useEffect)((function(){_(JSON.parse(localStorage.getItem("notifications")||"{}"))}),[]);var O=!!h&&!!m[h.username],y=O?"ON":"OFF";return h||(y="PLS LOG IN"),"undefined"!==typeof Notification&&"denied"===Notification.permission&&(O=!1,y="DENIED"),("undefined"===typeof navigator||!1 in navigator)&&(O=!1,y="UNSUPPORTED"),b(l.b,{onClick:function(){var e,t,o,c,u,s,l;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e=n.users[n.active],!(!1 in navigator)&&e){i.next=3;break}return i.abrupt("return");case 3:return t=m[e.username],i.next=6,a.a.awrap(navigator.serviceWorker.ready);case 6:return o=i.sent,i.next=9,a.a.awrap(o.pushManager.getSubscription());case 9:if(c=i.sent){i.next=26;break}return i.next=13,a.a.awrap(fetch(f.a+"/notifier/pushSubscriptionKey"));case 13:return u=i.sent,i.next=16,a.a.awrap(u.json());case 16:return s=i.sent,l=v(s.public),i.prev=18,i.next=21,a.a.awrap(o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:l}));case 21:c=i.sent,i.next=26;break;case 24:i.prev=24,i.t0=i.catch(18);case 26:return i.prev=26,i.next=29,a.a.awrap(r.post("/notifier/".concat(t?"un":"","subscribe"),d({},c.toJSON()),{params:{usersub:!0}}));case 29:_((function(n){var r=d({},n);return r[e.username]=!t,localStorage.setItem("notifications",JSON.stringify(r)),r})),i.next=34;break;case 32:i.prev=32,i.t1=i.catch(26);case 34:case"end":return i.stop()}}),null,null,[[18,24],[26,32]],Promise)},leftIcon:b(i.c,null),text:b(s.a.Fragment,null,"Notifications: ",b("span",{style:{color:O?"lime":"red"}},y))})}function v(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r[a]=n.charCodeAt(a);return r}},ecW4:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("o0o1"),a=n.n(r),o=n("ODXe"),c=n("q1tI"),u=n.n(c),s=n("q9vl"),l=n("O1IP"),i=n.n(l),p=u.a.createElement;function f(e){var t=Object(s.b)(),n=Object(o.a)(t,2),r=n[0],l=n[1],f=r.users[r.active],m=Object(c.useState)(e.title||""),d=m[0],_=m[1],v=Object(c.useState)(e.text||""),h=v[0],g=v[1],O=Object(c.useState)(!1),y=O[0],w=O[1],x=Object(c.useState)(!1),j=x[0],F=x[1],k=Object(c.useState)(!1),P=k[0],S=k[1],E=Object(c.useRef)();function N(e){switch(e.target.name){case"title":return _(e.target.value);case"text":return S(E.current.scrollHeight),g(e.target.value)}}return console.log(y),Object(c.useEffect)((function(){E&&E.current&&S(E.current.scrollHeight)}),[E]),p(u.a.Fragment,null,p("form",{onSubmit:function(t){return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),w(!0),n.next=4,a.a.awrap(b(1e3));case 4:if(console.log("Title:",d),console.log("Text:",h),!e.edit){n.next=13;break}return n.next=9,a.a.awrap(e.onEdit(h));case 9:return n.sent||F(!0),w(!1),n.abrupt("return");case 13:d.length>=1&&d.length<=150?l.post("/post/",{title:d,text:h}).then((function(t){e.close(),e.rerender(t.data.entityId),w(!1)})).catch((function(t){console.log(t),e.rerender(),w(!1)})):(w(!1),e.rerender(),e.close());case 14:case"end":return n.stop()}}),null,null,null,Promise)},className:i.a.postForm},p("div",{className:i.a.titleCounter,"data-invalid":d.length<1||d.length>150},p("input",{type:"text",className:i.a.title,value:d,onChange:N,name:"title",placeholder:"The post's title",autoComplete:"off",disabled:y||e.edit}),p("p",null,d.length,"/150")),p("textarea",{name:"text",value:h,onChange:N,placeholder:"Go ahead, unleash your creative Genius!",rows:"4",autoComplete:"off",disabled:y,ref:E,style:{height:P+3+"px"}}),p("div",{className:i.a.postButton},p("button",{type:"submit",value:"Post!","data-known":!Boolean(f),disabled:y},"Post!")),e.edit&&p("button",{value:"Cancel",disabled:y,onClick:function(){e.onEdit(null,!0)}},"Cancel"),p("div",{className:i.a.author},"as",p("span",{"data-known":Boolean(f)},f?f.username:"<UNKNOWN>"),j&&p("i",{style:{color:"red",marginLeft:"2em"}},"(an error occured)"))))}function b(e){return new Promise((function(t){setTimeout(t,e)}))}},yxmD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/places",function(){return n("2TGF")}])}},[["yxmD",0,1,4,5,7,2,3,6,8,10,9]]]);