(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{RNiq:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return D}));var r=n("o0o1"),a=n.n(r),c=n("q1tI"),i=n.n(c),o=n("8Kt/"),s=n.n(o),u=n("FCqg"),l=n("SKjy"),f=n("PmZg"),b=n("gbgE"),p=n("40RG"),v=n("ODXe"),g=(n("SQ9z"),n("UL8Z"),n("AeZb"),n("Cu94"),n("q9vl"));i.a.createElement;var d=n("ecW4"),O=n("NIcq"),w=n("ma3e"),h=n("Srb5"),y=n("jxK0"),m=n("rePB"),j=n("v0uu"),P=i.a.createElement;function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(){var e=Object(g.b)(),t=Object(v.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)({}),s=o[0],u=o[1],f=n.users[n.active],b=Object(c.useState)(!1);b[0],b[1];Object(c.useEffect)((function(){u(JSON.parse(localStorage.getItem("notifications")||"{}"))}),[]);var p=!!f&&!!s[f.username],d=p?"ON":"OFF";return f||(d="PLS LOG IN"),"undefined"!==typeof Notification&&"denied"===Notification.permission&&(p=!1,d="DENIED"),("undefined"===typeof navigator||!1 in navigator)&&(p=!1,d="UNSUPPORTED"),P(l.b,{onClick:function(){var e,t,c,i,o,l,f;return a.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(e=n.users[n.active],!(!1 in navigator)&&e){b.next=3;break}return b.abrupt("return");case 3:return t=s[e.username],b.next=6,a.a.awrap(navigator.serviceWorker.ready);case 6:return c=b.sent,b.next=9,a.a.awrap(c.pushManager.getSubscription());case 9:if(i=b.sent){b.next=26;break}return b.next=13,a.a.awrap(fetch(j.a+"/notifier/pushSubscriptionKey"));case 13:return o=b.sent,b.next=16,a.a.awrap(o.json());case 16:return l=b.sent,f=N(l.public),b.prev=18,b.next=21,a.a.awrap(c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:f}));case 21:i=b.sent,b.next=26;break;case 24:b.prev=24,b.t0=b.catch(18);case 26:return b.prev=26,b.next=29,a.a.awrap(r.post("/notifier/".concat(t?"un":"","subscribe"),x({},i.toJSON()),{params:{usersub:!0}}));case 29:u((function(n){var r=x({},n);return r[e.username]=!t,localStorage.setItem("notifications",JSON.stringify(r)),r})),b.next=34;break;case 32:b.prev=32,b.t1=b.catch(26);case 34:case"end":return b.stop()}}),null,null,[[18,24],[26,32]],Promise)},leftIcon:P(w.c,null),text:P(i.a.Fragment,null,"Notifications: ",P("span",{style:{color:p?"lime":"red"}},d))})}function N(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r[a]=n.charCodeAt(a);return r}var E=i.a.createElement;function D(){var e=Object(c.useState)(Math.random()),t=e[0],n=e[1];function r(e){if(console.log("rerender"),e)return n(e);n(Math.random())}return Object(c.useEffect)((function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/discussion/serviceworker.js").then((function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("registered -> ",e),navigator.serviceWorker.addEventListener("message",(function(e){}));case 2:case"end":return t.stop()}}),null,null,null,Promise)})).catch((function(e){console.log("error -> ",e)}))}),[]),E(y.d,null,E(s.a,null,E("title",null,"Civil Discussion")),E(g.a,null,E(h.a,{style:{backgroundColor:"#181a1b",height:"100vh",width:"100vw"}},E(u.a,{title:"Discussion",rerenderFunc:r},E(u.b,{icon:E(w.g,null),drawer:E(d.a,null)}),E(u.b,{icon:E(w.i,null)},E(l.a,null,E(l.b,{text:"Profile"}),E(l.b,{leftIcon:E(O.d,null),text:"Switch Acount"},E(p.b,null)),E(k,null),E(l.b,{leftIcon:E(O.c,null),text:"Account Settings"}))),E(u.b,{icon:E(O.c,null)},E(l.a,null,E(l.b,{text:"Dark Theme"}),E(l.b,{text:"Privacy Policy",link:"/discussion/privacy"})))),E(f.a,null,E(b.a,{rerender:t,rerenderFunc:r})))))}},"m0L+":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n("RNiq")}])}},[["m0L+",0,1,2,4,6,12,13,3,5,7,8,9,10,11]]]);